# config.yaml - Minimal configuration for CI and development
# For full configuration, copy my-config.yaml.example to my-config.yaml
# Environment variables like ${VAR_NAME} are resolved at runtime

# -----------------------------------------------------------------------
# 1. MAIN PATHS (use /tmp for CI, user home for local dev)
# -----------------------------------------------------------------------
music_library_path: ${HOME}/Music/Music/Music Library.musiclibrary
apple_scripts_dir: applescripts
logs_base_dir: /tmp/mgu-logs

# Python settings
python_settings:
  prevent_bytecode: true

# -----------------------------------------------------------------------
# 2. EXECUTION AND PERFORMANCE
# -----------------------------------------------------------------------
apple_script_concurrency: 2
applescript_timeout_seconds: 3600

applescript_timeouts:
  default: 3600
  full_library_fetch: 3600
  single_artist_fetch: 600
  batch_update: 1800

max_retries: 2
retry_delay_seconds: 1
cache_ttl_seconds: 1800
incremental_interval_minutes: 1

# -----------------------------------------------------------------------
# 3. FEATURE TOGGLES AND SETTINGS
# -----------------------------------------------------------------------
cleaning:
  remaster_keywords:
    - remaster
    - remastered
    - reissue
  album_suffixes_to_remove:
    - Remaster
    - Remastered

artist_renamer:
  config_path: artist-renames.yaml

exceptions:
  track_cleaning: []
  artist_cleaning: []

# -----------------------------------------------------------------------
# 4. LOGGING & OUTPUT FILES
# -----------------------------------------------------------------------
logging:
  enabled: true
  max_runs: 3
  main_log_file: main/main.log
  analytics_log_file: analytics/analytics.log
  csv_output_file: csv/track_list.csv
  changes_report_file: csv/changes_report.csv
  dry_run_report_file: reports/dry_run_report.html
  last_incremental_run_file: last_incremental_run.log
  pending_verification_file: csv/pending_year_verification.csv
  last_db_verify_log: main/last_db_verify.log
  levels:
    console: INFO
    main_file: DEBUG
    analytics_file: INFO

analytics:
  enabled: false
  duration_thresholds:
    short_max: 5
    medium_max: 20
    long_max: 50
  max_events: 10000
  compact_time: true

# -----------------------------------------------------------------------
# 5. YEAR RETRIEVAL CONFIGURATION
# -----------------------------------------------------------------------
year_retrieval:
  enabled: true
  preferred_api: musicbrainz

  api_auth:
    discogs_token: ${DISCOGS_TOKEN}
    musicbrainz_app_name: MusicGenreUpdater/2.0
    contact_email: ${CONTACT_EMAIL}
    use_lastfm: true
    lastfm_api_key: ${LASTFM_API_KEY}

  rate_limits:
    discogs_requests_per_minute: 55
    musicbrainz_requests_per_second: 1
    lastfm_requests_per_second: 5
    concurrent_api_calls: 2

  processing:
    batch_size: 25
    delay_between_batches: 20
    adaptive_delay: true
    cache_ttl_days: 36500
    pending_verification_interval_days: 30
    skip_prerelease: true
    future_year_threshold: 1
    prerelease_recheck_days: 30

  logic:
    min_valid_year: 1900
    absurd_year_threshold: 1970
    suspicion_threshold_years: 10
    definitive_score_threshold: 50
    definitive_score_diff: 15
    preferred_countries:
      - us
      - gb
      - de
      - fr
      - jp

  fallback:
    enabled: true
    year_difference_threshold: 5
    trust_api_score_threshold: 70

# -----------------------------------------------------------------------
# 6. BATCH PROCESSING
# -----------------------------------------------------------------------
batch_processing:
  enabled: true
  fetch_batch_size: 3000
  ids_batch_size: 200
  save_interval: 500
  auto_save: true

# -----------------------------------------------------------------------
# 7. LIBRARY SNAPSHOT
# -----------------------------------------------------------------------
library_snapshot:
  enabled: true
  snapshot_dir: cache/snapshots
  max_snapshots: 5
  compression: gzip
  delta_enabled: true
  checksum_algorithm: sha256
  debounce_seconds: 300
  min_age_seconds: 60
  max_memory_mb: 500

# -----------------------------------------------------------------------
# 8. API CACHING
# -----------------------------------------------------------------------
api_cache:
  enabled: true
  cache_dir: cache/api
  ttl_seconds: 1200
  max_size_mb: 100
  cleanup_interval_seconds: 3600

# -----------------------------------------------------------------------
# 9. TEST MODE
# -----------------------------------------------------------------------
test_artists:
  - Amon Amarth
  - Children of Bodom
  - Metallica
