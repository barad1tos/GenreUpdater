# üéµ Music Genre Autoupdater Service

–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π —Å–µ—Ä–≤—ñ—Å –¥–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Ä–æ–∫—ñ–≤ –∞–ª—å–±–æ–º—ñ–≤ –∑ MusicBrainz —Ç–∞ Discogs APIs.

## üöÄ –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç

### –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Å–µ—Ä–≤—ñ—Å—É

```bash
./manage_service.sh install
```

### –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É

```bash
./manage_service.sh status
```

### –ü–µ—Ä–µ–≥–ª—è–¥ –ª–æ–≥—ñ–≤

```bash
./manage_service.sh logs
```

## üìÖ –†–æ–∑–∫–ª–∞–¥ —Ä–æ–±–æ—Ç–∏

- **–ö–æ–ª–∏:** –©–æ–¥–Ω—è –æ 2:00 —Ä–∞–Ω–∫—É
- **–©–æ:** –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Ä–æ–∫—ñ–≤ –∞–ª—å–±–æ–º—ñ–≤ –¥–ª—è –≤—Å—ñ—î—ó –º—É–∑–∏—á–Ω–æ—ó –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏
- **–¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å:** 3-6 –≥–æ–¥–∏–Ω (–∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Ä–æ–∑–º—ñ—Ä—É –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏)

## üìä –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥

### –õ–æ–≥–∏ —Ä–æ–∑—Ç–∞—à–æ–≤–∞–Ω—ñ –≤:

- **LaunchCtl –ª–æ–≥–∏:** `~/Library/Mobile Documents/com~apple~CloudDocs/4. Dev/MGU logs/launchctl/`
- **–û—Å–Ω–æ–≤–Ω—ñ –ª–æ–≥–∏:** `~/Library/Mobile Documents/com~apple~CloudDocs/4. Dev/MGU logs/main/`
- **–ü–æ–º–∏–ª–∫–∏:** `~/Library/Mobile Documents/com~apple~CloudDocs/3. Git/Own/Python Scripts/Genres Autoupdater v2.0/error.log`
- **–ê–Ω–∞–ª—ñ—Ç–∏–∫–∞:** `~/Library/Mobile Documents/com~apple~CloudDocs/3. Git/Own/Python Scripts/Genres Autoupdater v2.0/analytics.log`

### –ö–æ–º–∞–Ω–¥–∏ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è:

| –ö–æ–º–∞–Ω–¥–∞                         | –û–ø–∏—Å              |
| ------------------------------- | ----------------- |
| `./manage_service.sh install`   | –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —Å–µ—Ä–≤—ñ—Å |
| `./manage_service.sh uninstall` | –í–∏–¥–∞–ª–∏—Ç–∏ —Å–µ—Ä–≤—ñ—Å   |
| `./manage_service.sh start`     | –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –∑–∞—Ä–∞–∑   |
| `./manage_service.sh stop`      | –ó—É–ø–∏–Ω–∏—Ç–∏          |
| `./manage_service.sh status`    | –ü–æ–∫–∞–∑–∞—Ç–∏ —Å—Ç–∞—Ç—É—Å   |
| `./manage_service.sh logs`      | –ü–æ–∫–∞–∑–∞—Ç–∏ –ª–æ–≥–∏     |
| `./manage_service.sh test`      | –¢–µ—Å—Ç–æ–≤–∏–π –∑–∞–ø—É—Å–∫   |

## ‚öôÔ∏è –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è

### –û—Å–Ω–æ–≤–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≤ `my-config.yaml`:

```yaml
# –¢–µ—Å—Ç–æ–≤—ñ –∞—Ä—Ç–∏—Å—Ç–∏ (–ø–æ—Ä–æ–∂–Ω—ñ–π = –≤—Å—è –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∞)
development:
  test_artists: [] # –î–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω
  debug_mode: true

# API —Ç–∞–π–º–∞—É—Ç–∏
applescript_timeouts:
  default: 3600 # 1 –≥–æ–¥–∏–Ω–∞ –¥–ª—è –ø–æ–≤–Ω–æ—ó –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏
  single_artist_fetch: 600 # 10 —Ö–≤–∏–ª–∏–Ω –¥–ª—è –æ–¥–Ω–æ–≥–æ –∞—Ä—Ç–∏—Å—Ç–∞
  full_library_fetch: 3600 # 1 –≥–æ–¥–∏–Ω–∞ –¥–ª—è –ø–æ–≤–Ω–æ—ó –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏

# Batch –æ–±—Ä–æ–±–∫–∞
year_retrieval:
  processing:
    batch_size: 25
    delay_between_batches: 20
```

## üîß –¢–µ—Ö–Ω—ñ—á–Ω—ñ –¥–µ—Ç–∞–ª—ñ

### –°–∏—Å—Ç–µ–º–Ω—ñ –≤–∏–º–æ–≥–∏:

- macOS –∑ Music.app
- Python 3.12+ (—á–µ—Ä–µ–∑ pyenv)
- –ê–∫—Ç–∏–≤–Ω—ñ API –∫–ª—é—á—ñ –¥–ª—è Discogs —Ç–∞ Last.fm
- –Ü–Ω—Ç–µ—Ä–Ω–µ—Ç –∑'—î–¥–Ω–∞–Ω–Ω—è

### –†–µ—Å—É—Ä—Å–∏:

- **–ü–∞–º'—è—Ç—å:** ~200MB –ø—ñ–¥ —á–∞—Å —Ä–æ–±–æ—Ç–∏
- **CPU:** Low priority (nice=10)
- **–ú–µ—Ä–µ–∂–∞:** ~1-2 API –∑–∞–ø–∏—Ç–∏ –Ω–∞ —Å–µ–∫—É–Ω–¥—É
- **–î–∏—Å–∫:** –õ–æ–≥–∏ —Ç–∞ –∫–µ—à ~50-100MB

### –ë–µ–∑–ø–µ–∫–∞:

- API –∫–ª—é—á—ñ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ñ –≤ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó
- –í–∞–ª—ñ–¥–∞—Ü—ñ—è –≤—Å—ñ—Ö –≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ—á–∏—â–µ–Ω–Ω—è –Ω–µ–±–µ–∑–ø–µ—á–Ω–∏—Ö —Å–∏–º–≤–æ–ª—ñ–≤
- Timeout –∑–∞—Ö–∏—Å—Ç –¥–ª—è –≤—Å—ñ—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π

## üÜò –î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º

### –°–µ—Ä–≤—ñ—Å –Ω–µ –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è:

```bash
# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å
./manage_service.sh status

# –ü–æ–¥–∏–≤–∏—Ç–∏—Å—è –ø–æ–º–∏–ª–∫–∏
./manage_service.sh logs

# –ü–µ—Ä–µ—ñ–Ω—Å—Ç–∞–ª—é–≤–∞—Ç–∏
./manage_service.sh uninstall
./manage_service.sh install
```

### –ü–æ–º–∏–ª–∫–∏ –≤ —Ä–æ–±–æ—Ç—ñ:

```bash
# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –æ—Å–Ω–æ–≤–Ω—ñ –ª–æ–≥–∏
tail -f "~/Library/Mobile Documents/com~apple~CloudDocs/4. Dev/MGU logs/main/main.log"

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ø–æ–º–∏–ª–∫–∏
tail -f error.log

# –¢–µ—Å—Ç–æ–≤–∏–π –∑–∞–ø—É—Å–∫
./manage_service.sh test
```

### –ß–∞—Å—Ç—ñ –ø—Ä–æ–±–ª–µ–º–∏:

| –ü—Ä–æ–±–ª–µ–º–∞             | –†—ñ—à–µ–Ω–Ω—è                                         |
| -------------------- | ----------------------------------------------- |
| AppleScript timeout  | –ó–±—ñ–ª—å—à–∏—Ç–∏ `applescript_timeouts` –≤ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó |
| API rate limits      | –ó–º–µ–Ω—à–∏—Ç–∏ `requests_per_second` –≤ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó   |
| –ü–æ–≤–Ω–∞ –ø–∞–º'—è—Ç—å        | –û—á–∏—Å—Ç–∏—Ç–∏ –∫–µ—à —Ñ–∞–π–ª–∏ –≤ logs –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó            |
| Music.app –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ | –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏ Music.app                         |

## üìà –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ

### –î–ª—è –≤–µ–ª–∏–∫–∏—Ö –±—ñ–±–ª—ñ–æ—Ç–µ–∫ (>20K —Ç—Ä–µ–∫—ñ–≤):

```yaml
# –ó–±—ñ–ª—å—à–∏—Ç–∏ batch —Ä–æ–∑–º—ñ—Ä
year_retrieval:
  processing:
    batch_size: 50
    delay_between_batches: 15

# –ó–±—ñ–ª—å—à–∏—Ç–∏ –∫–µ—à
caching:
  album_cache_max_entries: 100000
```

### –î–ª—è —à–≤–∏–¥–∫–æ–≥–æ —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç—É:

```yaml
# –ó–±—ñ–ª—å—à–∏—Ç–∏ —à–≤–∏–¥–∫—ñ—Å—Ç—å API –∑–∞–ø–∏—Ç—ñ–≤
year_retrieval:
  rate_limits:
    musicbrainz_requests_per_second: 2
    lastfm_requests_per_second: 10
```

## üîÑ –û–Ω–æ–≤–ª–µ–Ω–Ω—è

1. –ó—É–ø–∏–Ω–∏—Ç–∏ —Å–µ—Ä–≤—ñ—Å: `./manage_service.sh stop`
2. –û–Ω–æ–≤–∏—Ç–∏ –∫–æ–¥
3. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é
4. –ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Ç–µ—Å—Ç: `./manage_service.sh test`
5. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏: `./manage_service.sh start`

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–∏–π –¥–æ –ø—Ä–æ–¥–∞–∫—à–Ω—É  
**–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è:** –ü—Ä–æ–π–¥–µ–Ω–æ —É—Å–ø—ñ—à–Ω–æ  
**–û—Å—Ç–∞–Ω–Ω—î –æ–Ω–æ–≤–ª–µ–Ω–Ω—è:** 2025-08-28
